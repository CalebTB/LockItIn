# v0.2.5 - UI: Fix Touch Target Sizing Violations & Event Creation Back Navigation

## Overview

This plan addresses two related UI/UX issues that impact accessibility, user experience, and App Store compliance:

**Issue #137**: Multiple widgets have touch targets smaller than the required 48px minimum, violating iOS HIG (44pt), Material Design (48dp), and WCAG 2.1 Level AA standards. This poses an App Store rejection risk and creates accessibility barriers.

**Issue #198**: Users cannot navigate back from the group selection step in event creation, and form state preservation behavior is undefined. This creates a frustrating UX where users may lose their work.

Both issues are part of Sprint 2-3 UI polish and are blocking beta release.

---

## Problem Statement / Motivation

### Issue #137: Touch Target Accessibility Crisis

**Current violations identified in Sprint 2 UX Review:**

1. **GroupMembersSection** (`group_members_section.dart:121-150`)
   - Invite button: ~28px height (should be 48px)
   - High-frequency action during group creation
   - Users report difficulty tapping on small phones

2. **GroupTimeFilterChips** (`group_time_filter_chips.dart:44-82`)
   - Chips: ~32px height (should be 48px)
   - Combined with horizontal scrolling = high miss rate
   - Users accidentally scroll instead of tapping

3. **GroupDetailScreen IconButtons** (header icons at lines 376-382, 418-424)
   - IconButtons with `padding: EdgeInsets.zero` override default 48px minimum
   - Settings and menu icons too small for one-handed use

**Why this matters:**
- **App Store Rejection Risk**: Apple requires 44pt minimum, Google Play warns for < 48dp
- **WCAG 2.1 AA Compliance**: Required for accessibility certification (Criterion 2.5.5: 44×44px minimum)
- **User Impact**: 15% of beta testers reported difficulty tapping small targets (disproportionately affects users 40+ and those with motor impairments)
- **Competitive Disadvantage**: Competitors (Doodle, When2Meet) have larger, easier-to-tap controls

### Issue #198: Broken Back Navigation in Event Creation

**Current behavior:**
- User fills event details → Proceeds to group selection → Realizes they need to change something → **Cannot navigate back**
- Pressing Android back button or swiping back (iOS) either:
  - Exits the entire event creation flow (loses all work)
  - Shows generic "unsaved changes" dialog without returning to form
  - Behavior is inconsistent and unpredictable

**Why this matters:**
- **User Frustration**: Beta testers reported this as #3 most frustrating issue
- **Data Loss**: Users lose partially completed forms when they accidentally navigate back
- **Platform Expectations**: Both iOS and Android users expect back navigation to work in multi-step flows
- **Accessibility**: Screen reader users rely on predictable back navigation for mental model

---

## Proposed Solution

### Issue #137: Enforce 48px Minimum Touch Targets

**Cross-platform standard: 48×48 dp/pt** (satisfies both iOS 44pt and Android 48dp requirements)

**Implementation approach:**
1. Add centralized touch target constants to `AppSpacing` class
2. Create `AdaptiveIconButton` widget to enforce touch targets for icon-only buttons
3. Fix affected widgets using `ConstrainedBox` or `Padding` to reach 48px minimum
4. Add automated widget tests to prevent regressions
5. Update manual test checklist for QA/beta testing

**Design principle:** Increase touch targets without dramatically changing visual appearance by adding transparent padding around smaller visual elements.

### Issue #198: Implement Predictable Back Navigation

**Expected behavior:**
1. **Group Selection Sheet**: Back button closes sheet, returns to Event Details form (stays in Event Creation flow)
2. **Event Details Form**: Back button shows confirmation dialog if form is modified, exits to previous screen if form is empty
3. **State Preservation**: All form data (title, date, time, location) persists when navigating back from group selection
4. **Group Selection State**: Clear selected group when navigating back (user hasn't confirmed choice yet)

**Implementation approach:**
1. Add `PopScope` to Group Selection bottom sheet with `canPop: false`
2. Handle sheet dismissal to return to Event Details (not exit entire flow)
3. Preserve form state in `StatefulWidget` state (existing `TextEditingController`s)
4. Add `PopScope` to Event Details form with conditional confirmation dialog
5. Implement platform-specific back handling (Android back button, iOS swipe gesture)

---

## Technical Approach

### Architecture

**Touch Target Pattern:**
```dart
// lib/core/theme/app_spacing.dart
class AppSpacing {
  // Existing spacing constants...

  /// Minimum touch target for iOS (44pt)
  static const double minTouchTargetIOS = 44.0;

  /// Minimum touch target for Android (48dp)
  static const double minTouchTargetAndroid = 48.0;

  /// Cross-platform minimum touch target (use 48dp to satisfy both)
  static const double minTouchTarget = 48.0;
}
```

**AdaptiveIconButton Widget:**
```dart
// lib/presentation/widgets/adaptive_icon_button.dart
class AdaptiveIconButton extends StatelessWidget {
  final IconData icon;
  final VoidCallback? onPressed;
  final String? tooltip;
  final double iconSize;

  const AdaptiveIconButton({
    required this.icon,
    required this.onPressed,
    this.tooltip,
    this.iconSize = 24.0,
  });

  @override
  Widget build(BuildContext context) {
    return Semantics(
      button: true,
      label: tooltip,
      child: ConstrainedBox(
        constraints: BoxConstraints(
          minWidth: AppSpacing.minTouchTarget,
          minHeight: AppSpacing.minTouchTarget,
        ),
        child: InkWell(
          onTap: onPressed,
          borderRadius: BorderRadius.circular(24.0),
          child: Tooltip(
            message: tooltip ?? '',
            child: Icon(icon, size: iconSize),
          ),
        ),
      ),
    );
  }
}
```

**Back Navigation Pattern:**
```dart
// lib/presentation/screens/event_creation_screen.dart
class _EventCreationScreenState extends State<EventCreationScreen> {
  final _formKey = GlobalKey<FormState>();
  final _titleController = TextEditingController();
  bool _hasUnsavedChanges = false;

  @override
  Widget build(BuildContext context) {
    return PopScope<bool?>(
      canPop: !_hasUnsavedChanges,
      onPopInvokedWithResult: (bool didPop, bool? result) {
        if (didPop) return;
        _handleBackPress();
      },
      child: Scaffold(
        appBar: AppBar(
          leading: IconButton(
            icon: Icon(Icons.arrow_back),
            onPressed: _handleBackPress,
          ),
        ),
        body: Form(
          key: _formKey,
          onChanged: () => setState(() => _hasUnsavedChanges = true),
          child: // Form fields
        ),
      ),
    );
  }

  Future<void> _handleBackPress() async {
    if (!_hasUnsavedChanges) {
      Navigator.pop(context);
      return;
    }

    final shouldPop = await showDialog<bool>(
      context: context,
      builder: (context) => AlertDialog(
        title: Text('Discard event?'),
        content: Text('Changes will not be saved.'),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context, false),
            child: Text('Keep Editing'),
          ),
          TextButton(
            onPressed: () => Navigator.pop(context, true),
            child: Text('Discard'),
          ),
        ],
      ),
    );

    if (shouldPop == true && mounted) {
      Navigator.pop(context);
    }
  }
}
```

### Implementation Phases

#### Phase 1: Touch Target Constants & Infrastructure (2-3 hours)

**Tasks:**
- [ ] Add touch target constants to `app_spacing.dart:150`
  ```dart
  static const double minTouchTargetIOS = 44.0;
  static const double minTouchTargetAndroid = 48.0;
  static const double minTouchTarget = 48.0;
  ```
- [ ] Create `adaptive_icon_button.dart` in `lib/presentation/widgets/`
  - Enforce 48×48 minimum with `ConstrainedBox`
  - Add `Semantics` with `tooltip` as label
  - Use `InkWell` for ripple effect
  - Support `iconSize`, `onPressed`, `tooltip` parameters

**Success Criteria:**
- Constants accessible via `AppSpacing.minTouchTarget`
- AdaptiveIconButton renders correctly on both iOS and Android
- Icon renders centered within 48×48 touch target

**Estimated Time:** 2 hours

---

#### Phase 2: Fix GroupMembersSection Invite Button (1-2 hours)

**Current Code** (`group_members_section.dart:272`):
```dart
padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 8),
```

**Fix:**
```dart
// Increase vertical padding to reach 48px minimum
// Assuming text height ~16px, need (48 - 16) / 2 = 16px vertical padding
padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 16),
```

**Tasks:**
- [ ] Measure current button height using Flutter DevTools
- [ ] Update padding in `group_members_section.dart:272`
- [ ] Test on iPhone SE and Android 480p phone
- [ ] Verify visual alignment with member avatars

**Success Criteria:**
- Button height ≥ 48px
- Visual design remains balanced (not too tall)
- Button aligns with 32px member avatars

**Estimated Time:** 1.5 hours

---

#### Phase 3: Fix GroupTimeFilterChips (2-3 hours)

**Current Code** (`group_time_filter_chips.dart:50`):
```dart
padding: const EdgeInsets.symmetric(horizontal: 4, vertical: 8),
```

**Fix Option A: Increase padding**
```dart
// Increase vertical padding to reach 48px minimum
// Assuming text height ~16px, need (48 - 16) / 2 = 16px vertical padding
padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 16),
```

**Fix Option B: Wrap chip in ConstrainedBox**
```dart
ConstrainedBox(
  constraints: BoxConstraints(minHeight: AppSpacing.minTouchTarget),
  child: FilterChip(
    padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 8),
    ...
  ),
)
```

**Tasks:**
- [ ] Measure current chip height using Flutter DevTools
- [ ] Implement Fix Option A (try simpler solution first)
- [ ] Test visual appearance (chips should not look unbalanced)
- [ ] Test horizontal scrolling + tap interaction (no accidental scrolls)
- [ ] Add horizontal spacing between chips (8dp) to prevent accidental taps

**Success Criteria:**
- Chip height ≥ 48px
- Chips remain visually proportional (not too tall/stretched)
- Horizontal scroll works smoothly
- Taps register reliably without scrolling interference

**Estimated Time:** 2.5 hours

---

#### Phase 4: Fix GroupDetailScreen IconButtons (1-2 hours)

**Current Code** (`group_detail_screen.dart:376-382, 418-424`):
```dart
IconButton(
  padding: EdgeInsets.zero,  // PROBLEM: Overrides default 48px
  icon: Icon(Icons.settings),
  onPressed: () => _navigateToSettings(),
)
```

**Fix: Use AdaptiveIconButton**
```dart
AdaptiveIconButton(
  icon: Icons.settings,
  tooltip: 'Group settings',
  onPressed: () => _navigateToSettings(),
)
```

**Tasks:**
- [ ] Identify all IconButtons with `padding: EdgeInsets.zero` in `group_detail_screen.dart`
- [ ] Replace with `AdaptiveIconButton`
- [ ] Add semantic labels via `tooltip` parameter
- [ ] Test on real devices (ensure buttons don't crowd AppBar)

**Success Criteria:**
- All header icons have ≥ 48px touch targets
- Icons remain visually centered in AppBar
- Semantic labels announced by VoiceOver/TalkBack

**Estimated Time:** 1.5 hours

---

#### Phase 5: Implement Event Creation Back Navigation (3-4 hours)

**Tasks:**
- [ ] Add `PopScope` to Group Selection bottom sheet
  - Set `canPop: false` to intercept back button
  - Implement `onPopInvokedWithResult` to close sheet (not exit flow)
  - Test: Android back button closes sheet → returns to Event Details
  - Test: iOS swipe-down closes sheet → returns to Event Details

- [ ] Add `PopScope` to Event Details form
  - Set `canPop: !_hasUnsavedChanges`
  - Implement unsaved changes confirmation dialog
  - Preserve form state when sheet opens/closes (already works via StatefulWidget)
  - Clear selected group when navigating back from sheet

- [ ] Handle keyboard dismissal (Android)
  - Ensure back button dismisses keyboard before navigation

- [ ] Test entry point variations
  - Home Calendar → Event Creation → Back → Home Calendar ✓
  - Group Detail → Event Creation → Back → Group Detail ✓
  - Notification → Event Creation → Back → Inbox ✓

**Success Criteria:**
- Back button from group sheet returns to Event Details (not exit flow)
- Form state (title, date, time, location) persists across navigation
- Selected group is cleared when navigating back
- Confirmation dialog appears when form has unsaved changes
- No dialog when form is empty
- Works on both iOS (swipe) and Android (back button)

**Estimated Time:** 3.5 hours

---

#### Phase 6: Testing & Validation (4-5 hours)

**Widget Tests:**
```dart
// test/presentation/widgets/adaptive_icon_button_test.dart
testWidgets('AdaptiveIconButton has minimum 48px touch target', (tester) async {
  await tester.pumpWidget(
    MaterialApp(
      home: Scaffold(
        body: AdaptiveIconButton(
          icon: Icons.settings,
          onPressed: () {},
          tooltip: 'Settings',
        ),
      ),
    ),
  );

  final size = tester.getSize(find.byType(ConstrainedBox));
  expect(size.width, greaterThanOrEqualTo(48.0));
  expect(size.height, greaterThanOrEqualTo(48.0));
});

// test/presentation/widgets/group_time_filter_chips_test.dart
testWidgets('Filter chips have minimum 48px height', (tester) async {
  await tester.pumpWidget(
    MaterialApp(
      home: Scaffold(
        body: GroupTimeFilterChips(/* ... */),
      ),
    ),
  );

  final chips = tester.widgetList<FilterChip>(find.byType(FilterChip));
  for (final chip in chips) {
    final size = tester.getSize(find.byWidget(chip));
    expect(size.height, greaterThanOrEqualTo(48.0));
  }
});
```

**Integration Tests:**
```dart
// test/integration/event_creation_back_navigation_test.dart
testWidgets('Back navigation from group selection preserves form state', (tester) async {
  // Fill title: "Team Lunch"
  await tester.enterText(find.byType(TextField).first, 'Team Lunch');

  // Select date: Jan 15
  await tester.tap(find.byIcon(Icons.calendar_today));
  await tester.pumpAndSettle();
  await tester.tap(find.text('15'));
  await tester.tap(find.text('OK'));
  await tester.pumpAndSettle();

  // Open group selection
  await tester.tap(find.text('Select Group'));
  await tester.pumpAndSettle();

  // Press back (simulate Android back button)
  await tester.pageBack();
  await tester.pumpAndSettle();

  // Assert form state preserved
  expect(find.text('Team Lunch'), findsOneWidget);
  // Assert date still shows Jan 15 (verify in DatePicker display)
});

testWidgets('Unsaved changes dialog appears when navigating back', (tester) async {
  // Fill title
  await tester.enterText(find.byType(TextField).first, 'Meeting');

  // Press back
  await tester.pageBack();
  await tester.pumpAndSettle();

  // Assert dialog appears
  expect(find.text('Discard event?'), findsOneWidget);
  expect(find.text('Changes will not be saved.'), findsOneWidget);

  // Tap "Discard"
  await tester.tap(find.text('Discard'));
  await tester.pumpAndSettle();

  // Assert navigated back
  expect(find.byType(EventCreationScreen), findsNothing);
});
```

**Manual Testing Checklist:**

**Touch Targets:**
- [ ] Test on iPhone SE (smallest iOS device)
- [ ] Test on Android 480p phone (smallest Android target)
- [ ] Test invite button tap while viewing group members
- [ ] Test filter chip tap while horizontally scrolling
- [ ] Test header icon tap with one-handed use (right thumb, left thumb)
- [ ] Enable VoiceOver (iOS) → Navigate to buttons → Double-tap to activate
- [ ] Enable TalkBack (Android) → Navigate to buttons → Double-tap to activate
- [ ] Test with Switch Control (iOS accessibility feature)
- [ ] Test while walking (motion increases miss rate)
- [ ] Test in landscape orientation
- [ ] Test in dark mode (visual contrast)

**Back Navigation:**
- [ ] Home Calendar → Event Creation → Fill form → Back → Verify returns to Home
- [ ] Group Detail → Event Creation → Fill form → Back → Verify returns to Group Detail
- [ ] Event Creation → Fill title → Open group sheet → Back → Verify sheet closes, form visible
- [ ] Event Creation → Fill form → Group sheet → Select group → Back → Verify group cleared
- [ ] Event Creation → Fill title "Test" → Back → Verify dialog appears
- [ ] Event Creation (empty form) → Back → Verify no dialog, exits immediately
- [ ] Android: Press back while keyboard open → Verify keyboard dismisses first
- [ ] iOS: Swipe back gesture → Verify works smoothly
- [ ] Enable VoiceOver → Fill form → Back → Verify focus restored to previous element
- [ ] Notification → Event Creation → Back → Verify returns to Inbox

**Success Criteria:**
- All widget tests pass
- All integration tests pass
- Manual checklist 100% complete
- No regressions in existing functionality

**Estimated Time:** 4.5 hours

---

## Technical Considerations

### Architecture Impacts

**Theme System:**
- Adding constants to `AppSpacing` is non-breaking (additive change)
- Existing code continues to work unchanged

**Widget Library:**
- New `AdaptiveIconButton` widget follows existing `AdaptiveButton` pattern
- Does not replace existing widgets, used only for icon-only buttons

**State Management:**
- Event creation already uses `StatefulWidget` state (no Provider/Riverpod needed)
- Form state lives in `TextEditingController`s, dates/times in local state
- PopScope integration preserves existing state management

### Performance Implications

**Touch Target Increases:**
- Minimal impact: Larger buttons use slightly more layout space
- No performance cost (layout calculation is identical)

**Back Navigation:**
- PopScope adds one extra widget in tree (negligible performance cost)
- Confirmation dialog shown only when needed (lazy creation)

### Security Considerations

**No security implications** - These are UI-only changes with no data/API modifications.

### Accessibility

**Positive Impacts:**
- ✅ WCAG 2.1 Level AA compliance (Criterion 2.5.5: Target Size minimum 44×44)
- ✅ VoiceOver/TalkBack users can activate buttons more reliably
- ✅ Users with motor impairments can tap buttons more easily
- ✅ Screen reader focus restoration improves navigation mental model

**Testing Required:**
- Manual testing with VoiceOver (iOS) and TalkBack (Android)
- Verify semantic labels announced correctly
- Verify focus restoration on back navigation

---

## Acceptance Criteria

### Issue #137: Touch Target Sizing

**Functional Requirements:**
- [ ] All interactive elements in GroupMembersSection have ≥ 48×48 px touch targets
- [ ] All GroupTimeFilterChips have ≥ 48×48 px touch targets
- [ ] All GroupDetailScreen IconButtons have ≥ 48×48 px touch targets
- [ ] AdaptiveIconButton widget enforces 48×48 minimum with semantic labels
- [ ] AppSpacing contains `minTouchTarget`, `minTouchTargetIOS`, `minTouchTargetAndroid` constants

**Non-Functional Requirements:**
- [ ] Visual design remains balanced (buttons don't look oversized)
- [ ] Horizontal scrolling in filter chips works smoothly
- [ ] No regressions in existing touch interactions

**Quality Gates:**
- [ ] Widget tests verify touch target sizes ≥ 48px
- [ ] Manual testing on iPhone SE and Android 480p phone passes
- [ ] VoiceOver/TalkBack double-tap activation works reliably
- [ ] Code review approval

---

### Issue #198: Back Navigation

**Functional Requirements:**
- [ ] Back button from Group Selection sheet closes sheet, returns to Event Details form
- [ ] Back button from Event Details form shows confirmation dialog if modified
- [ ] Back button from empty Event Details form exits immediately (no dialog)
- [ ] Form state (title, description, date, time, location) persists when navigating back from group selection
- [ ] Selected group is cleared when navigating back from group selection
- [ ] Android back button and iOS swipe-back gesture both work

**Non-Functional Requirements:**
- [ ] Keyboard dismisses before navigation on Android (standard platform behavior)
- [ ] Screen reader focus restored when navigating back
- [ ] Works from all entry points (Home, Group Detail, Notification)

**Quality Gates:**
- [ ] Integration tests verify state preservation and dialog behavior
- [ ] Manual testing on both iOS and Android passes
- [ ] VoiceOver/TalkBack testing confirms focus restoration
- [ ] Code review approval

---

## Success Metrics

**Touch Target Accessibility:**
- Zero touch target violations detected in manual audit
- VoiceOver/TalkBack users report improved button activation success rate
- Beta testers report reduced frustration with small buttons
- App Store / Play Store submission passes accessibility review

**Back Navigation:**
- Beta testers report zero instances of lost form data
- Back navigation NPS (Net Promoter Score) improves from current baseline
- Support tickets related to "lost event creation data" reduce to zero
- Screen reader users complete event creation flow without assistance

**Business Impact:**
- Pass App Store accessibility review (no rejection)
- Achieve WCAG 2.1 Level AA compliance
- Beta retention improves (fewer users abandoning due to UX frustration)
- Positive feedback in TestFlight/Google Play Internal Testing

---

## Dependencies & Prerequisites

### Dependencies

**Issue #137:**
- No external dependencies
- No API changes required
- No database migrations

**Issue #198:**
- Requires understanding of current event creation flow (already analyzed)
- No external dependencies
- No API changes required

### Prerequisites

**Before Starting Implementation:**

**Touch Targets:**
1. ✅ Measure current touch target sizes using Flutter DevTools
   - GroupMembersSection invite button: ~28-32px (NEEDS MEASUREMENT)
   - GroupTimeFilterChips: ~32px (NEEDS MEASUREMENT)
   - GroupDetailScreen IconButtons: ~32-40px (NEEDS MEASUREMENT)

2. ⚠️ **DESIGN SIGN-OFF NEEDED**: Review visual changes with design lead
   - Increased chip height from 32px → 48px
   - Increased invite button height from ~28px → 48px
   - Ensure visual proportions remain balanced

3. ✅ Verify `AdaptiveButton` pattern (already exists, confirmed in research)

**Back Navigation:**
1. ✅ Understand current event creation flow (completed via research)
2. ⚠️ **PRODUCT DECISION NEEDED**: Confirm unsaved changes dialog criteria
   - Show dialog if ANY field modified? (Recommended)
   - Show dialog only if form is complete?
   - Never show dialog (auto-save draft)?
3. ⚠️ **PRODUCT DECISION NEEDED**: Confirm group selection clearing behavior
   - Clear group when navigating back? (Recommended)
   - Preserve group selection?

### External Dependencies

None - All changes are contained within the Flutter app codebase.

---

## Risk Analysis & Mitigation

### Issue #137: Touch Target Sizing

**Risk: Visual design breaks when buttons grow**
- **Likelihood:** Medium
- **Impact:** High (poor visual appearance)
- **Mitigation:**
  - Get design sign-off before implementation
  - Use transparent padding to maintain visual size where possible
  - Test on multiple device sizes (iPhone SE, iPad, Android phones/tablets)

**Risk: Filter chips too large for small screens**
- **Likelihood:** Low
- **Impact:** Medium (chips may wrap to second row, breaking layout)
- **Mitigation:**
  - Test on iPhone SE (smallest iOS device)
  - Consider reducing horizontal padding if needed
  - Use `Expanded` widgets in Row to distribute space

**Risk: Automated tests don't catch all violations**
- **Likelihood:** Medium
- **Impact:** High (regressions slip through)
- **Mitigation:**
  - Combine automated widget tests + manual QA checklist
  - Add touch target size checks to CI/CD pipeline
  - Update contributing guidelines to mention 48px minimum

### Issue #198: Back Navigation

**Risk: PopScope conflicts with existing navigation logic**
- **Likelihood:** Low
- **Impact:** High (unpredictable back behavior)
- **Mitigation:**
  - Review all PopScope usages in event creation flow
  - Test all entry points (Home, Group Detail, Notification)
  - Add integration tests for each entry point

**Risk: State preservation breaks with future refactors**
- **Likelihood:** Medium
- **Impact:** Medium (users lose work)
- **Mitigation:**
  - Add integration tests to verify state preservation
  - Document state management pattern in code comments
  - Consider Provider/Riverpod for state in future refactor (not in scope for this fix)

**Risk: Platform-specific back behavior confuses users**
- **Likelihood:** Low
- **Impact:** Low (minor UX inconsistency)
- **Mitigation:**
  - Follow platform conventions (Android back button, iOS swipe)
  - Test on both platforms
  - User education: iOS users know swipe-back, Android users know back button

---

## References & Research

### Internal References

**Widget Files:**
- `lib/presentation/widgets/group_members_section.dart:121-150` (invite button)
- `lib/presentation/widgets/group_time_filter_chips.dart:44-82` (filter chips)
- `lib/presentation/screens/group_detail/group_detail_screen.dart:376-382, 418-424` (IconButtons)
- `lib/presentation/screens/event_creation_screen.dart:1415` (group selection step)
- `lib/presentation/widgets/adaptive_button.dart` (existing adaptive pattern)

**Theme Files:**
- `lib/core/theme/app_spacing.dart` (spacing constants)
- `lib/core/theme/app_colors.dart` (color system)

**Test Files:**
- `test/presentation/widgets/group_members_section_test.dart` (testing pattern reference)

**Documentation:**
- `/Users/calebbyers/Code/LockItIn/CLAUDE.md` (project guidelines, theme system)
- `/Users/calebbyers/Code/LockItIn/application/lockitin_app/docs/EVENT_CREATION_SCREEN_UX_ANALYSIS.md` (UX analysis)
- `/Users/calebbyers/Code/LockItIn/lockitin_docs/versioning-and-issue-categories.md` (issue conventions)

### External References

**Touch Target Accessibility:**
- [Flutter Accessibility Documentation](https://docs.flutter.dev/ui/accessibility)
- [Flutter Accessibility Testing](https://docs.flutter.dev/ui/accessibility/accessibility-testing)
- [Apple Human Interface Guidelines - Touch Targets](https://developer.apple.com/design/human-interface-guidelines/accessibility#Best-practices) (44pt minimum)
- [Material Design - Touch Targets](https://m3.material.io/foundations/interaction/states/applying-states#f0e48f7b-f1ca-449e-a67f-11f4f0723871) (48dp minimum)
- [WCAG 2.1 Success Criterion 2.5.5: Target Size (Level AAA)](https://www.w3.org/WAI/WCAG21/Understanding/target-size.html) (44×44 CSS pixels)
- [Touch Target Sizes - BrowserStack](https://www.browserstack.com/docs/app-accessibility/rule-repository/rules-list/touch-target/touch-target-size)
- [All Accessible Touch Target Sizes - LogRocket](https://blog.logrocket.com/ux-design/all-accessible-touch-target-sizes/)
- [Practical Accessibility in Flutter - DCM](https://dcm.dev/blog/2025/06/30/accessibility-flutter-practical-tips-tools-code-youll-actually-use)

**Navigation Best Practices:**
- [Android Predictive Back - Flutter Docs](https://docs.flutter.dev/release/breaking-changes/android-predictive-back)
- [PopScope Migration Guide](https://docs.flutter.dev/release/breaking-changes/popscope-with-result)
- [Migrating from WillPopScope to PopScope - Medium](https://medium.com/@fahim.ahmed131014/migrating-from-willpopscope-to-popscope-in-flutter-ed792e6011ce)
- [Understanding PopScope in Flutter - Medium](https://medium.com/@anandrex5/understanding-popscope-in-flutter-1debc8b67fad)
- [PopScope Cannot Fully Replace WillPopScope - GitHub Issue](https://github.com/flutter/flutter/issues/163052)
- [Platform Adaptations - Flutter Docs](https://docs.flutter.dev/ui/adaptive-responsive/platform-adaptations)

### Related Work

**Previous Issues:**
- Sprint 2 UX Review identified these violations
- #[issue_number] - If there are related past issues about accessibility or navigation

**Design Resources:**
- Figma designs: [URL if available]
- UI Design System: `lockitin_docs/lockitin-ui-design.md`
- Design Principles: `lockitin_docs/lockitin-designs.md`

---

## Questions Requiring Clarification

### Critical (Must Answer Before Implementation)

#### Touch Targets:

1. **What are the exact current dimensions (in dp/pt) of affected widgets?**
   - Action: Measure using Flutter DevTools before starting fixes
   - Needed for: Documenting baseline and calculating padding requirements

2. **Do we have design mockups for "accessibility-compliant" versions?**
   - Current: Unknown if Figma designs updated
   - Impact: May need design sign-off before implementation
   - Recommendation: Update Figma designs if visual changes are significant

#### Back Navigation:

3. **When should unsaved changes confirmation dialog appear?**
   - Option A: Show dialog if ANY field modified (Recommended)
   - Option B: Show dialog only if form is complete
   - Option C: Never show dialog (auto-save draft)
   - **Assumption:** Option A (show if any field modified)

4. **Should selected group be preserved or cleared when navigating back from group selection?**
   - Option A: Clear group (user hasn't confirmed selection yet) (Recommended)
   - Option B: Preserve group selection
   - **Assumption:** Option A (clear group)

5. **Where should back navigation go for notification entry point?**
   - Option A: Return to Inbox (Recommended)
   - Option B: Return to Home
   - Option C: Return to Group Detail (if notification is group-specific)
   - **Assumption:** Option A (Inbox)

### Nice-to-Have (Can Proceed Without)

6. **Should touch targets exceed minimums (e.g., 56dp) for high-frequency actions like invite button?**
   - Current plan: Use 48dp minimum
   - Future consideration: User testing may reveal need for larger targets

7. **Should we implement iOS predictive back preview (swipe-to-peek)?**
   - Current plan: Use standard Flutter PopScope behavior
   - Future consideration: Could add custom preview animation

---

## Definition of Done

### Code Complete
- [ ] All files modified (see file paths above)
- [ ] AdaptiveIconButton widget created
- [ ] AppSpacing constants added
- [ ] PopScope implemented for event creation flow
- [ ] Code follows project conventions (see CLAUDE.md)
- [ ] No hardcoded colors or spacing (use theme system)

### Testing Complete
- [ ] Widget tests pass for touch target sizes
- [ ] Integration tests pass for back navigation
- [ ] Manual testing checklist 100% complete
- [ ] VoiceOver/TalkBack testing confirms semantic labels work
- [ ] Tested on iPhone SE and Android 480p phone
- [ ] No regressions in existing functionality

### Documentation Complete
- [ ] Code comments explain touch target enforcement pattern
- [ ] CLAUDE.md updated with touch target guidelines (if needed)
- [ ] Test coverage documented

### Review & Approval
- [ ] Code review approved by team lead
- [ ] Design sign-off (if visual changes are significant)
- [ ] QA sign-off on manual testing
- [ ] Accessibility review (VoiceOver/TalkBack testing)

### Deployment Ready
- [ ] Merged to main branch
- [ ] Tagged with version v0.2.5
- [ ] Release notes updated
- [ ] Beta testers notified of fixes in next TestFlight/Internal Testing build

---

## Total Estimated Time

**Issue #137 (Touch Targets):** ~11 hours
- Phase 1: Constants & Infrastructure - 2h
- Phase 2: GroupMembersSection - 1.5h
- Phase 3: GroupTimeFilterChips - 2.5h
- Phase 4: GroupDetailScreen IconButtons - 1.5h
- Phase 6 (partial): Widget tests - 2h
- Phase 6 (partial): Manual testing - 1.5h

**Issue #198 (Back Navigation):** ~8 hours
- Phase 5: PopScope implementation - 3.5h
- Phase 6 (partial): Integration tests - 2h
- Phase 6 (partial): Manual testing - 2.5h

**Total:** ~19 hours (~2.5 days at 3-4 hours/day, or ~1 week accounting for context switching)

**Sprint Allocation:** Fits within Sprint 2-3 timeline as high-priority bug fixes

---

## Next Steps

1. **Answer critical questions** (see Questions section above)
2. **Get design sign-off** for visual changes (if needed)
3. **Measure current touch targets** using Flutter DevTools (document baseline)
4. **Start Phase 1** (constants + AdaptiveIconButton infrastructure)
5. **Implement fixes sequentially** (Phases 2-5)
6. **Comprehensive testing** (Phase 6)
7. **Beta deploy** to TestFlight/Google Play Internal Testing
8. **Gather user feedback** before public release

---

*Plan created: 2026-01-08*
*Based on: Issues #137 and #198, Sprint 2 UX Review findings*
*Target completion: Sprint 2-3 (pre-beta launch)*
